

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creator-Defined Statements &mdash; Ren&#39;Py Documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/custom.css?v=c659a740" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/general.css?v=c0a7eb24" />
      <link rel="stylesheet" type="text/css" href="_static/dark_mode_css/dark.css?v=70edf1c7" />

  
    <link rel="canonical" href="https://www.renpy.org/doc/html/cds.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=ea47c46f"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script src="_static/dark_mode_js/default_light.js?v=c2e647ce"></script>
      <script src="_static/dark_mode_js/theme_switcher.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Custom Text Tags" href="custom_text_tags.html" />
    <link rel="prev" title="Creator-Defined Displayables" href="cdd.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

<a href="https://www.renpy.org/" style="margin-bottom: 0">Ren'Py Visual Novel Engine
<img src="_static/navbar-logo.png" alt="Logo" style="width: 93px; height: 100px; border-radius: 0; margin: 0 auto; padding: 0; margin-top: 5px; background-color: unset;" />
</a>

<a href="index.html" style="margin-bottom: 0px">8.4.0 Documentation</a>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">GUI Customization Guide</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">The Ren'Py Language</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="language_basics.html">Language Basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="label.html">Labels &amp; Control Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="dialogue.html">Dialogue and Narration</a></li>
<li class="toctree-l1"><a class="reference internal" href="displaying_images.html">Displaying Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="menus.html">In-Game Menus</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="conditional.html">Conditional Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio.html">Audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="audio_filters.html">Audio Filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="movie.html">Movie</a></li>
<li class="toctree-l1"><a class="reference internal" href="voice.html">Voice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text, Displayables, Transforms, and Transitions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="text.html">Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="translation.html">Translation</a></li>
<li class="toctree-l1"><a class="reference internal" href="displayables.html">Displayables</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="transform_properties.html">Transform Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="transitions.html">Transitions</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrixcolor.html">Matrixcolor</a></li>
<li class="toctree-l1"><a class="reference internal" href="layeredimage.html">Layered Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="3dstage.html">3D Stage</a></li>
<li class="toctree-l1"><a class="reference internal" href="live2d.html">Live2D Cubism</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Customizing Ren'Py</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="style.html">Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="style_properties.html">Style Properties</a></li>
<li class="toctree-l1"><a class="reference internal" href="screens.html">Screens and Screen Language</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_actions.html">Screen Actions, Values, and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_special.html">Special Screen Names</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_optimization.html">Screen Language Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Configuration Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="preferences.html">Preference Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="store_variables.html">Store Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="mouse.html">Custom Mouse Cursors</a></li>
<li class="toctree-l1"><a class="reference internal" href="textshaders.html">Text Shaders</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="launcher.html">Launcher</a></li>
<li class="toctree-l1"><a class="reference internal" href="developer_tools.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="director.html">Interactive Director</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Functionality</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="nvl_mode.html">NVL-Mode Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="bubble.html">Speech Bubbles</a></li>
<li class="toctree-l1"><a class="reference internal" href="input.html">Text Input</a></li>
<li class="toctree-l1"><a class="reference internal" href="side_image.html">Side Images</a></li>
<li class="toctree-l1"><a class="reference internal" href="rooms.html">Image Gallery, Music Room, and Replay Actions</a></li>
<li class="toctree-l1"><a class="reference internal" href="drag_drop.html">Drag and Drop</a></li>
<li class="toctree-l1"><a class="reference internal" href="sprites.html">Sprites</a></li>
<li class="toctree-l1"><a class="reference internal" href="keymap.html">Customizing the Keymap</a></li>
<li class="toctree-l1"><a class="reference internal" href="achievement.html">Achievements</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Dialogue History</a></li>
<li class="toctree-l1"><a class="reference internal" href="multiple.html">Multiple Character Dialogue</a></li>
<li class="toctree-l1"><a class="reference internal" href="splashscreen_presplash.html">Splashscreen and Presplash</a></li>
<li class="toctree-l1"><a class="reference internal" href="lifecycle.html">Lifecycle of a Ren'Py game</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Python and Ren'Py</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="statement_equivalents.html">Statement Equivalents</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load_rollback.html">Saving, Loading, and Rollback</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent.html">Persistent Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui_advanced.html">Advanced GUI</a></li>
<li class="toctree-l1"><a class="reference internal" href="screen_python.html">Screens and Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="cdd.html">Creator-Defined Displayables</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Creator-Defined Statements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api-reference">API Reference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lexer-object">Lexer object</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Lexer"><code class="docutils literal notranslate"><span class="pre">Lexer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lint-utility-functions">Lint Utility Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custom_text_tags.html">Custom Text Tags</a></li>
<li class="toctree-l1"><a class="reference internal" href="character_callbacks.html">Character Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_python.html">File Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="color_class.html">Color Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="matrix.html">Matrix</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Model-Based Rendering</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Other Functions and Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="ren_py.html">_ren.py Files - Ren'Py in Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="fetch.html">HTTPS/HTTP Fetch</a></li>
<li class="toctree-l1"><a class="reference internal" href="screenshot.html">Screenshots</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Building, Updating, and Other Platforms</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build.html">Building Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="android.html">Android</a></li>
<li class="toctree-l1"><a class="reference internal" href="ios.html">iOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="web.html">Web / HTML5</a></li>
<li class="toctree-l1"><a class="reference internal" href="chromeos.html">Chrome OS/Chromebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="raspi.html">Raspberry Pi</a></li>
<li class="toctree-l1"><a class="reference internal" href="iap.html">In-App Purchasing</a></li>
<li class="toctree-l1"><a class="reference internal" href="updater.html">HTTPS/HTTP Updater</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloader.html">Downloader for Large Games on Mobile</a></li>
<li class="toctree-l1"><a class="reference internal" href="gesture.html">Gestures</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">End-User Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="problems.html">Dealing with Problems</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_variables.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="self_voicing.html">Self-Voicing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Library and Tool Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="template_projects.html">Template Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Engine Developer Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="editor.html">Text Editor Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="skins.html">Skins</a></li>
<li class="toctree-l1"><a class="reference internal" href="translating_renpy.html">Translating Ren'Py</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Changes, License, and Credits</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog (Ren'Py 7.x-)</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog6.html">Changelog (Ren'Py 6.11 - 6.99)</a></li>
<li class="toctree-l1"><a class="reference internal" href="incompatible.html">Incompatible Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="sponsors.html">Ren'Py Development Sponsors</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Ren'Py Visual Novel Engine</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Creator-Defined Statements</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/renpy/renpy/blob/master/sphinx/source/cds.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creator-defined-statements">
<h1>Creator-Defined Statements<a class="headerlink" href="#creator-defined-statements" title="Link to this heading"></a></h1>
<p>Creator-Defined Statements (CDS) allow you to add your own statements to
Ren'Py's scripting language. This makes it possible to add functionality that
is not supported by the current syntax.</p>
<p>CDS can be more flexible than the direct Python code equivalent.</p>
<p>For example, picking a line of dialogue at random:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">introduction</span><span class="p">:</span>
    <span class="k">python</span><span class="p">:</span>
        <span class="n">greetings</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Hello.&#39;</span><span class="p">,</span> <span class="s1">&#39;Welcome.&#39;</span><span class="p">,</span> <span class="s1">&#39;Can I help you?&#39;</span><span class="p">]</span>
        <span class="n">greeting</span> <span class="o">=</span> <span class="n">renpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="k">choice</span><span class="p">(</span><span class="n">greetings</span><span class="p">)</span>

    <span class="s2">&quot;[greeting]&quot;</span>
</pre></div>
</div>
<p>Ren'Py's parser does not know ahead of time what happens in the python block or how it should be executed.
It does not do anything with this code until execution and triggers an error if an exception occurs.</p>
<p>Using a CDS allows you to:</p>
<ul class="simple">
<li><p>Check the correctness of the parsed syntax (For example, check that the items in the list sent to renpy.random.choice have valid text)</p></li>
<li><p>Ignore incorrect data at execution (For non-critical functions, it is often better to skip the execution than to throw an exception)</p></li>
<li><p>Predict Displayables (If the function uses them)</p></li>
<li><p>Give you addition information during <a class="reference internal" href="developer_tools.html#lint"><span class="std std-ref">Lint</span></a> (If at runtime an error was ignored you can have a report here).</p></li>
</ul>
<p>For example, the above behaviour, but written as a CDS:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">python</span> <span class="n">early</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">parse_random</span><span class="p">(</span><span class="n">lexer</span><span class="p">):</span>
        <span class="n">subblock_lexer</span> <span class="o">=</span> <span class="n">lexer</span><span class="o">.</span><span class="n">subblock_lexer</span><span class="p">()</span>
        <span class="n">choices</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">while</span> <span class="n">subblock_lexer</span><span class="o">.</span><span class="n">advance</span><span class="p">():</span>
            <span class="k">with</span> <span class="n">subblock_lexer</span><span class="o">.</span><span class="n">catch_error</span><span class="p">():</span>
                <span class="n">statement</span> <span class="o">=</span> <span class="n">subblock_lexer</span><span class="o">.</span><span class="n">renpy_statement</span><span class="p">()</span>
                <span class="n">choices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">statement</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">choices</span>


    <span class="k">def</span> <span class="nf">next_random</span><span class="p">(</span><span class="n">choices</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">renpy</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="k">choice</span><span class="p">(</span><span class="n">choices</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">lint_random</span><span class="p">(</span><span class="n">parsed_object</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="k">in</span> <span class="n">parsed_object</span><span class="p">:</span>
                <span class="n">check</span> <span class="o">=</span> <span class="n">renpy</span><span class="o">.</span><span class="n">check_text_tags</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="k">block</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">what</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
                    <span class="n">renpy</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">check</span><span class="p">)</span>


    <span class="n">renpy</span><span class="o">.</span><span class="n">register_statement</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;random&quot;</span><span class="p">,</span>
        <span class="k">block</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">parse</span><span class="o">=</span><span class="n">parse_random</span><span class="p">,</span>
        <span class="nb">next</span><span class="o">=</span><span class="n">next_random</span><span class="p">,</span>
        <span class="n">lint</span><span class="o">=</span><span class="n">lint_random</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">random</span></code> is now available as a statement:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">label</span> <span class="n">introduction</span><span class="p">:</span>
    <span class="n">random</span><span class="p">:</span>
        <span class="s2">&quot;Hello.&quot;</span>
        <span class="s2">&quot;Welcome.&quot;</span>
        <span class="s2">&quot;Can I help you?&quot;</span>
</pre></div>
</div>
<p>Using a CDS does not guarantee that the execution will be successful,
but the better you code your statement, the better Ren'Py can &quot;understand&quot; what
you expect from it.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Link to this heading"></a></h2>
<p>Creator-Defined Statements (CDS) must conform to the following rules:</p>
<ul class="simple">
<li><p>They must be defined in a <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">early</span></code> block.</p></li>
<li><p>They cannot be used in the same file in which they are defined.</p></li>
<li><p>The file containing the CDS must be loaded earlier than any file that uses it.
(Since Ren'Py loads files in the Unicode sort order of their path, it generally makes sense to
prefix the name of any file containing a CDS with 01 or some other small number.)</p></li>
</ul>
<p>Creator-Defined Statements are registered using the <code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.register_statement()</span></code>
function. This functions takes other functions that perform operations on the content of the CDS.</p>
<p>For example, a new statement named <code class="docutils literal notranslate"><span class="pre">line</span></code> that allows lines of text to be specified
without quotes.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="n">line</span> <span class="n">e</span> <span class="s2">&quot;These quotes will show up,&quot;</span> <span class="n">Eileen</span> <span class="n">said</span><span class="p">,</span> <span class="s2">&quot;and don&#39;t need to be backslashed.&quot;</span>
</pre></div>
</div>
<p>The parse function will be sent the lexed content for parsing.
The execute function should run an operation on the parsed content.
The lint function should report any errors in the parsed content.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">python</span> <span class="n">early</span><span class="p">:</span>
    <span class="k">def</span> <span class="nf">parse_smartline</span><span class="p">(</span><span class="n">lexer</span><span class="p">):</span>
        <span class="n">who</span> <span class="o">=</span> <span class="n">lexer</span><span class="o">.</span><span class="n">simple_expression</span><span class="p">()</span>
        <span class="n">what</span> <span class="o">=</span> <span class="n">lexer</span><span class="o">.</span><span class="n">rest</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">who</span><span class="p">,</span> <span class="n">what</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">execute_smartline</span><span class="p">(</span><span class="n">parsed_object</span><span class="p">):</span>
        <span class="n">who</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="n">parsed_object</span>
        <span class="n">renpy</span><span class="o">.</span><span class="n">say</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">who</span><span class="p">),</span> <span class="n">what</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">lint_smartline</span><span class="p">(</span><span class="n">parsed_object</span><span class="p">):</span>
        <span class="n">who</span><span class="p">,</span> <span class="n">what</span> <span class="o">=</span> <span class="n">parsed_object</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">eval</span><span class="p">(</span><span class="n">who</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">renpy</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Character not defined: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">who</span><span class="p">))</span>

        <span class="n">tte</span> <span class="o">=</span> <span class="n">renpy</span><span class="o">.</span><span class="n">check_text_tags</span><span class="p">(</span><span class="n">what</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tte</span><span class="p">:</span>
            <span class="n">renpy</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="n">tte</span><span class="p">)</span>

    <span class="n">renpy</span><span class="o">.</span><span class="n">register_statement</span><span class="p">(</span>
        <span class="s2">&quot;line&quot;</span><span class="p">,</span>
        <span class="n">parse</span><span class="o">=</span><span class="n">parse_smartline</span><span class="p">,</span>
        <span class="n">execute</span><span class="o">=</span><span class="n">execute_smartline</span><span class="p">,</span>
        <span class="n">lint</span><span class="o">=</span><span class="n">lint_smartline</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="api-reference">
<h2>API Reference<a class="headerlink" href="#api-reference" title="Link to this heading"></a></h2>
<section id="lexer-object">
<h3>Lexer object<a class="headerlink" href="#lexer-object" title="Link to this heading"></a></h3>
<p>A custom statement's parse function takes an instance of a Lexer object.</p>
<dl class="py class">
<dt class="sig sig-object py" id="Lexer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Lexer</span></span><a class="headerlink" href="#Lexer" title="Link to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="Lexer.error">
<span class="sig-name descname"><span class="pre">error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.error" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> (<em>str</em>) -- Message to add to the list of detected parsing errors.</p>
</dd>
</dl>
<p>Add <cite>msg</cite> (with the current position) to the list of detected
parsing errors. This interrupts the parsing of the current statement,
but does not prevent further parsing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.require">
<span class="sig-name descname"><span class="pre">require</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thing</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.require" title="Link to this definition"></a></dt>
<dd><p>Try to parse <cite>thing</cite> and report an error if it cannot be done.</p>
<p>If <cite>thing</cite> is a string, try to parse it using <a class="reference internal" href="#Lexer.match" title="Lexer.match"><code class="xref py py-func docutils literal notranslate"><span class="pre">match()</span></code></a>.</p>
<p>Otherwise, thing must be another method on this lexer object which is
called without arguments.</p>
<p>If <cite>name</cite> is not specified, the name of the method will be used in the
message (or <cite>thing</cite> if it's a string), otherwise <cite>name</cite> will be used.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.eol">
<span class="sig-name descname"><span class="pre">eol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.eol" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the lexer is at the end of the line, else False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.expect_eol">
<span class="sig-name descname"><span class="pre">expect_eol</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.expect_eol" title="Link to this definition"></a></dt>
<dd><p>If not at the end of the line, raise an error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.expect_noblock">
<span class="sig-name descname"><span class="pre">expect_noblock</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stmt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.expect_noblock" title="Link to this definition"></a></dt>
<dd><p>Called to indicate this statement does not expect a block.
If a block is found, raise an error. <cite>stmt</cite> should be a string,
it will be added to the message with an error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.expect_block">
<span class="sig-name descname"><span class="pre">expect_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stmt</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.expect_block" title="Link to this definition"></a></dt>
<dd><p>Called to indicate that the statement requires that a non-empty
block is present. <cite>stmt</cite> should be a string, it will be added
to the message with an error.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.has_block">
<span class="sig-name descname"><span class="pre">has_block</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.has_block" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>True if the current line has a non-empty block, else False.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.match">
<span class="sig-name descname"><span class="pre">match</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">re</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.match" title="Link to this definition"></a></dt>
<dd><p>Match an arbitrary regexp string.</p>
<p>All of the statements in the lexer that match things are implemented
in terms of this function. They first skip whitespace, then attempt
to match against the line. If the match succeeds, the matched text
is returned. Otherwise, None is returned, and the state of the lexer
is unchanged.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.keyword">
<span class="sig-name descname"><span class="pre">keyword</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.keyword" title="Link to this definition"></a></dt>
<dd><p>Match <cite>s</cite> as a keyword.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.name">
<span class="sig-name descname"><span class="pre">name</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.name" title="Link to this definition"></a></dt>
<dd><p>Match a name. This does not match built-in keywords.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.word">
<span class="sig-name descname"><span class="pre">word</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.word" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The text of the matched word.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Match any word, including keywords.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.image_name_component">
<span class="sig-name descname"><span class="pre">image_name_component</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.image_name_component" title="Link to this definition"></a></dt>
<dd><p>Match an image name component. Unlike a word, an image name
component can begin with a number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.string">
<span class="sig-name descname"><span class="pre">string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.string" title="Link to this definition"></a></dt>
<dd><p>Match a Ren'Py string.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.integer">
<span class="sig-name descname"><span class="pre">integer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.integer" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>String containing the found integer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Match an integer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.float">
<span class="sig-name descname"><span class="pre">float</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.float" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>String containing the found floating point number.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
<p>Match a floating point number.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.label_name">
<span class="sig-name descname"><span class="pre">label_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">declare</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.label_name" title="Link to this definition"></a></dt>
<dd><p>Match a label name, either absolute or relative. If <cite>declare</cite>
is true, then the global label name is set. (Note that this does not
actually declare the label - the statement is required to do that
by returning it from the <cite>label</cite> function.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.simple_expression">
<span class="sig-name descname"><span class="pre">simple_expression</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.simple_expression" title="Link to this definition"></a></dt>
<dd><p>Match a simple Python expression, returns it as a string.
This is often used when you expect a variable name.
It is not recommended to change the result. The correct action is
to evaluate the result in the future.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.delimited_python">
<span class="sig-name descname"><span class="pre">delimited_python</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delim</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.delimited_python" title="Link to this definition"></a></dt>
<dd><p>Match a Python expression that ends in a <cite>delim</cite>, for example ':'.
This is often used when you expect a condition until the delimiter.
It is not recommended to change the result. The correct action is
to evaluate the result in the future. This raises an error if
end of line is reached before the delimiter.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.arguments">
<span class="sig-name descname"><span class="pre">arguments</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.arguments" title="Link to this definition"></a></dt>
<dd><p>This must be called before the parentheses with the arguments list,
if they are not specified returns None, otherwise
returns an object representing the arguments to a function
call. This object has an <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> method on it that
takes an optional <cite>scope</cite> dictionary, and returns a tuple
in which the first component is a tuple of positional arguments,
and the second component is a dictionary of keyword arguments.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.rest">
<span class="sig-name descname"><span class="pre">rest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.rest" title="Link to this definition"></a></dt>
<dd><p>Skip whitespace, then return the rest of the line.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.checkpoint">
<span class="sig-name descname"><span class="pre">checkpoint</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.checkpoint" title="Link to this definition"></a></dt>
<dd><p>Return an opaque object representing the current state of the lexer.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.revert">
<span class="sig-name descname"><span class="pre">revert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">o</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.revert" title="Link to this definition"></a></dt>
<dd><p>When <cite>o</cite> is the object returned from checkpoint(), reverts the state
of the lexer to what it was when checkpoint() was called. (This is
used for backtracking.)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.subblock_lexer">
<span class="sig-name descname"><span class="pre">subblock_lexer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.subblock_lexer" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A Lexer for the block associated with the current line.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.advance">
<span class="sig-name descname"><span class="pre">advance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.advance" title="Link to this definition"></a></dt>
<dd><p>In a subblock lexer, advance to the next line. This must be called
before the first line, so the first line can be parsed. Return True
if we've successfully advanced to a line in the block, or False
if we have advanced beyond all lines in the block.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.renpy_statement">
<span class="sig-name descname"><span class="pre">renpy_statement</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.renpy_statement" title="Link to this definition"></a></dt>
<dd><p>When called, this parses the current line as a Ren'Py script statement,
generating an error if this is not possible. This method returns
an opaque object that can be returned from the <cite>next</cite> function passed to
<code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.register_statement()</span></code>, or passed
to <code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.jump()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">renpy.call()</span></code>. This object should
not be stored except as part of the parse result of the statement.</p>
<p>When the statement returned from this completes, control is
transferred to the statement after the creator-defined statement.
(Which might be the statement created using post_execute).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.renpy_block">
<span class="sig-name descname"><span class="pre">renpy_block</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">empty</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.renpy_block" title="Link to this definition"></a></dt>
<dd><p>Parse all of the remaining lines in the current block
as Ren'Py script, and return a SubParse corresponding to the
first statement in the block. The block is chained together such
that all statements in the block are run, and then control is
transferred to the statement after this creator-defined statement.</p>
<p>Note that this parses the current block. In the more likely
case that you'd like to parse the subblock of the current
statement, the correct way to do that is:</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mystatement_parse</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>

    <span class="n">l</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">l</span><span class="o">.</span><span class="n">expect_eol</span><span class="p">()</span>
    <span class="n">l</span><span class="o">.</span><span class="n">expect_block</span><span class="p">(</span><span class="s2">&quot;mystatement&quot;</span><span class="p">)</span>

    <span class="na">child</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">subblock_lexer</span><span class="p">()</span><span class="o">.</span><span class="n">renpy_block</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span> <span class="s2">&quot;child&quot;</span> <span class="p">:</span> <span class="na">child</span> <span class="p">}</span>
</pre></div>
</div>
<dl>
<dt><cite>empty</cite></dt><dd><p>If True, allows an empty block to be parsed. (An empty block
is equivalent to a block with a single <code class="docutils literal notranslate"><span class="pre">pass</span></code> statement.)</p>
<p>If False, an empty block triggers an error.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Lexer.catch_error">
<span class="sig-name descname"><span class="pre">catch_error</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Lexer.catch_error" title="Link to this definition"></a></dt>
<dd><p>This is a context decorator, used in conjunction with the with
statement, that catches and reports lexer errors inside its
context block, then continues after the block.</p>
<p>Here's an example of how it can be used to report multiple errors
in a single subblock.</p>
<div class="highlight-renpy notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mystatement_parse</span><span class="p">(</span><span class="n">l</span><span class="p">):</span>

    <span class="n">l</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
    <span class="n">l</span><span class="o">.</span><span class="n">expect_eol</span><span class="p">()</span>
    <span class="n">l</span><span class="o">.</span><span class="n">expect_block</span><span class="p">(</span><span class="s2">&quot;mystatement&quot;</span><span class="p">)</span>

    <span class="k">strings</span> <span class="o">=</span> <span class="p">[</span> <span class="p">]</span>
    <span class="n">ll</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">subblock_lexer</span><span class="p">()</span>

    <span class="k">while</span> <span class="n">ll</span><span class="o">.</span><span class="n">advance</span><span class="p">():</span>
        <span class="k">with</span> <span class="n">ll</span><span class="o">.</span><span class="n">catch_error</span><span class="p">():</span>
            <span class="k">strings</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ll</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">ll</span><span class="o">.</span><span class="n">string</span><span class="p">))</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">expect_noblock</span><span class="p">(</span><span class="s2">&quot;string inside mystatement&quot;</span><span class="p">)</span>
            <span class="n">ll</span><span class="o">.</span><span class="n">expect_eol</span><span class="p">()</span>

    <span class="k">return</span> <span class="p">{</span> <span class="s2">&quot;strings&quot;</span> <span class="p">:</span> <span class="k">strings</span> <span class="p">}</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="lint-utility-functions">
<h3>Lint Utility Functions<a class="headerlink" href="#lint-utility-functions" title="Link to this heading"></a></h3>
<p>These functions are useful when writing lint functions.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cdd.html" class="btn btn-neutral float-left" title="Creator-Defined Displayables" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="custom_text_tags.html" class="btn btn-neutral float-right" title="Custom Text Tags" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>